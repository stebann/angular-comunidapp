<div class="comercios-container">
  <!-- Lista de comercios -->
  <div class="comercios-list-view">
    <!-- Cabecera reutilizable -->
    <app-search-header
      placeholder="Buscar comercios..."
      [(searchTerm)]="searchTerm"
    >
      <app-button
        type="outline-primary"
        size="sm"
        [icon]="soloFavoritos ? 'pi pi-star-fill' : 'pi pi-star'"
        (clicked)="toggleSoloFavoritos()"
        [ngClass]="{ 'active-favorites': soloFavoritos }"
      >
        Favoritos
      </app-button>
      <app-button
        type="outline-primary"
        size="sm"
        icon="pi pi-filter"
        (clicked)="openFilters()"
      >
        Filtros
      </app-button>
    </app-search-header>

    <div class="content-area">
      <div
        *ngIf="comerciosFiltrados.length > 0; else noComercios"
        class="comercios-grid"
      >
        <div
          *ngFor="let comercio of comerciosFiltrados; trackBy: trackByFn"
          class="comercio-card"
        >
          <div class="comercio-imagen" (click)="abrirDetalleComercio(comercio)">
            <img [src]="comercio.imagen" [alt]="comercio.nombre" />
          </div>

          <div class="comercio-info" (click)="abrirDetalleComercio(comercio)">
            <button
              class="favorite-btn"
              (click)="toggleFavorito(comercio); $event.stopPropagation()"
              [class.active]="esFavorito(comercio.id)"
            >
              <i
                class="pi"
                [class.pi-star]="!esFavorito(comercio.id)"
                [class.pi-star-fill]="esFavorito(comercio.id)"
              ></i>
            </button>

            <h3 class="comercio-nombre">{{ comercio.nombre }}</h3>

            <p class="comercio-descripcion">{{ comercio.descripcion }}</p>

            <div class="comercio-details">
              <div class="detail-item">
                <i class="pi pi-map-marker"></i>
                <span>{{ comercio.ubicacion }}</span>
              </div>
              <div class="detail-item">
                <i class="pi pi-phone"></i>
                <span>{{ comercio.telefono }}</span>
              </div>
            </div>

            <div class="card-footer" *ngIf="comercio.horario">
              <div class="detail-item">
                <i class="pi pi-clock"></i>
                <span>{{ comercio.horario }}</span>
              </div>
              <span class="categoria-tag">{{ comercio.categoria }}</span>
            </div>
          </div>
        </div>
      </div>

      <ng-template #noComercios>
        <div class="no-comercios">
          <i class="pi pi-building"></i>
          <h3>No hay comercios disponibles</h3>
          <p>Pronto verás negocios en tu comunidad aquí.</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>

<app-generic-filter
  [form]="filtro"
  [(isOpen)]="isOpen"
  (applyFilter)="onFiltersApplied()"
>
  <div style="display: flex; gap: 1rem">
    <app-input-date-field
      formControlName="fechaInicio"
      label="Fecha inicio"
    ></app-input-date-field>
    <app-input-date-field
      formControlName="fechaFin"
      label="Fecha fin"
    ></app-input-date-field>
  </div>

  <app-dropdown-field
    label="Campo 2"
    formControlName="campo2"
    [options]="opciones"
  ></app-dropdown-field>

  <app-input-field
    label="Campo 1"
    formControlName="campo1"
    placeholder="Ingrese valor para campo 1"
  ></app-input-field>
</app-generic-filter>
