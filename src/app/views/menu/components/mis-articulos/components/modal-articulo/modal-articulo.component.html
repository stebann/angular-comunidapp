<div class="modal-container">
  <form [formGroup]="form" (ngSubmit)="submit()">
    <div class="modal-content">
      <!-- Sección de fotos (izquierda) -->
      <div class="photos-section">
        <div class="photo-upload-area" (click)="onPhotoUpload()">
          <!-- Placeholder cuando no hay fotos -->
          <div class="upload-placeholder" *ngIf="photos.length === 0">
            <i class="pi pi-camera"></i>
            <h3>Agregar fotos del artículo</h3>
            <p>Haz clic para seleccionar imágenes</p>
            <span class="upload-hint">Formatos: JPG, PNG, WEBP</span>
          </div>

          <!-- Carrusel de fotos en el mismo contenedor -->
          <div
            class="photos-carousel"
            *ngIf="photos.length > 0"
            (click)="$event.stopPropagation()"
          >
            <div class="carousel-container">
              <div
                class="carousel-track"
                [style.transform]="
                  'translateX(-' + currentPhotoIndex * 100 + '%)'
                "
              >
                <div
                  class="carousel-slide"
                  *ngFor="let photo of photos; let i = index"
                >
                  <img
                    [src]="photo"
                    [alt]="'Foto ' + (i + 1)"
                    class="carousel-image"
                  />
                  <button class="remove-photo" (click)="removePhoto(i)">
                    <i class="pi pi-times"></i>
                  </button>
                </div>
              </div>
            </div>
            <!-- Indicadores dentro de la imagen -->
            <div class="carousel-indicators-overlay" *ngIf="photos.length > 1">
              <span
                *ngFor="let photo of photos; let i = index"
                class="indicator"
                [class.active]="i === currentPhotoIndex"
                (click)="goToPhoto(i)"
              >
              </span>
            </div>
          </div>
        </div>

        <!-- Controles abajo del contenedor de fotos -->
        <div class="carousel-controls" *ngIf="photos.length > 0">
          <button
            class="carousel-btn prev"
            (click)="previousPhoto()"
            [disabled]="currentPhotoIndex === 0"
            *ngIf="photos.length > 1"
          >
            <i class="pi pi-chevron-left"></i>
          </button>

          <button
            class="carousel-btn next"
            (click)="nextPhoto()"
            [disabled]="currentPhotoIndex === photos.length - 1"
            *ngIf="photos.length > 1"
          >
            <i class="pi pi-chevron-right"></i>
          </button>

          <!-- Botón para agregar más fotos -->
          <button class="add-more-btn" (click)="onPhotoUpload()">
            <i class="pi pi-plus"></i>
            <span>Agregar más</span>
          </button>
        </div>
      </div>

      <!-- Sección del formulario (derecha) -->
      <div class="form-section">
        <div class="form-grid">
          <app-input-field
            label="Título"
            placeholder="Título del artículo"
            formControlName="titulo"
          ></app-input-field>

          <app-input-field
            label="Descripción"
            placeholder="Descripción"
            formControlName="descripcion"
          ></app-input-field>

          <app-dropdown-field
            label="Categoría"
            [options]="[]"
            placeholder="Seleccionar..."
            formControlName="categoriaId"
          ></app-dropdown-field>

          <div class="form-row">
            <app-dropdown-field
              label="Estado"
              [options]="[]"
              placeholder="Seleccionar..."
              formControlName="estadoId"
            ></app-dropdown-field>

            <app-dropdown-field
              label="Tipo"
              [options]="[]"
              placeholder="Seleccionar..."
              formControlName="tipoTransaccionId"
            ></app-dropdown-field>
          </div>

          <app-input-field
            label="Precio"
            placeholder="0"
            formControlName="precio"
          ></app-input-field>
        </div>
      </div>
    </div>

    <!-- Botones de acción -->
    <div class="actions">
      <button type="button" class="btn btn-secondary" (click)="close()">
        Cancelar
      </button>
      <button type="submit" class="btn btn-primary">Guardar</button>
    </div>
  </form>

  <!-- Input oculto para subir fotos -->
  <input
    type="file"
    #fileInput
    multiple
    accept="image/*"
    (change)="onFileSelected($event)"
    style="display: none"
  />
</div>
