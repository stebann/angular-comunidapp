<div class="image-viewer-overlay" *ngIf="isOpen" (click)="closeViewer()">
  <div class="image-viewer-content" (click)="$event.stopPropagation()">
    <img
      [src]="getImageSrc(images[currentIndex])"
      [alt]="'Image ' + (currentIndex + 1) + ' of ' + images.length"
      class="viewer-image"
      [style.transform]="'scale(' + zoomLevel + ') translate(' + translateX + 'px, ' + translateY + 'px)'"
      [style.cursor]="zoomLevel > 1 ? 'move' : 'zoom-in'"
      (wheel)="onWheel($event)"
      (mousedown)="onMouseDown($event)"
      (mousemove)="onMouseMove($event)"
      (mouseup)="onMouseUp()"
      (mouseleave)="onMouseUp()"
      (touchstart)="onTouchStart($event)"
      (touchmove)="onTouchMove($event)"
      (touchend)="onTouchEnd()"
      (dblclick)="onDoubleClick()"
    />
    
    <!-- Zoom controls -->
    <div class="zoom-controls" *ngIf="images.length > 0">
      <button
        type="button"
        class="zoom-btn zoom-in-btn"
        [disabled]="zoomLevel >= maxZoom"
        (click)="zoomIn()"
        title="Acercar (Ctrl + Scroll up)"
      >
        <i class="pi pi-search-plus"></i>
      </button>
      <button
        type="button"
        class="zoom-btn zoom-out-btn"
        [disabled]="zoomLevel <= minZoom"
        (click)="zoomOut()"
        title="Alejar (Ctrl + Scroll down)"
      >
        <i class="pi pi-search-minus"></i>
      </button>
      <button
        type="button"
        class="zoom-btn reset-btn"
        (click)="resetZoom()"
        title="Restablecer tamaÃ±o (Double click)"
      >
        <i class="pi pi-compress"></i>
      </button>
    </div>
    
    <button
      type="button"
      class="viewer-nav-btn prev-viewer-btn"
      [disabled]="!canGoPrev()"
      (click)="prevImage()"
      *ngIf="images.length > 1"
    >
      <i class="pi pi-chevron-left"></i>
    </button>
    <button
      type="button"
      class="viewer-nav-btn next-viewer-btn"
      [disabled]="!canGoNext()"
      (click)="nextImage()"
      *ngIf="images.length > 1"
    >
      <i class="pi pi-chevron-right"></i>
    </button>
    <div class="viewer-counter" *ngIf="images.length > 1">
      {{ currentIndex + 1 }} / {{ images.length }}
    </div>
  </div>
  <button
    type="button"
    class="close-viewer-btn"
    (click)="closeViewer()"
    title="Cerrar (Esc)"
  >
    <i class="pi pi-times"></i>
  </button>
</div>
